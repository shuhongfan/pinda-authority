(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68e676f2"],{"09f4":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),Math.easeInOutQuad=function(e,t,r,s){return e/=s/2,e<1?r/2*e*e+t:(e--,-r/2*(e*(e-2)-1)+t)};var s=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function o(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function a(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function n(e,t,r){var n=a(),i=e-n,l=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=l;var a=Math.easeInOutQuad(c,n,i,t);o(a),c<t?s(e):r&&"function"===typeof r&&r()};u()}},"1b25":function(e,t,r){"use strict";var s=r("5346"),o=r.n(s);o.a},"2f21":function(e,t,r){"use strict";var s=r("79e5");e.exports=function(e,t){return!!e&&s((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},5346:function(e,t,r){},"55dd":function(e,t,r){"use strict";var s=r("5ca1"),o=r("d8e8"),a=r("4bf8"),n=r("79e5"),i=[].sort,l=[1,2,3];s(s.P+s.F*(n((function(){l.sort(void 0)}))||!n((function(){l.sort(null)}))||!r("2f21")(i)),"Array",{sort:function(e){return void 0===e?i.call(a(this)):i.call(a(this),o(e))}})},"7d18":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"role"},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{xs:24,sm:14}},[r("div",{staticClass:"app-container"},[r("div",{staticClass:"filter-container"},[r("el-input",{staticClass:"filter-item search-item",attrs:{placeholder:e.$t("table.role.roleName")},model:{value:e.queryParams.roleName,callback:function(t){e.$set(e.queryParams,"roleName",t)},expression:"queryParams.roleName"}}),e._v(" "),r("el-button",{staticClass:"filter-item",attrs:{type:"primary",plain:""},on:{click:e.search}},[e._v("\n            "+e._s(e.$t("table.search"))+"\n          ")]),e._v(" "),r("el-button",{staticClass:"filter-item",attrs:{type:"warning",plain:""},on:{click:e.reset}},[e._v("\n            "+e._s(e.$t("table.reset"))+"\n          ")]),e._v(" "),r("el-dropdown",{directives:[{name:"has-any-permission",rawName:"v-has-any-permission",value:["role:add","role:delete","role:export"],expression:"['role:add','role:delete','role:export']"}],staticClass:"filter-item",attrs:{trigger:"click"}},[r("el-button",[e._v("\n              "+e._s(e.$t("table.more"))),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{directives:[{name:"has-permission",rawName:"v-has-permission",value:["role:add"],expression:"['role:add']"}],nativeOn:{click:function(t){return e.add(t)}}},[e._v(e._s(e.$t("table.add")))]),e._v(" "),r("el-dropdown-item",{directives:[{name:"has-permission",rawName:"v-has-permission",value:["role:delete"],expression:"['role:delete']"}],nativeOn:{click:function(t){return e.batchDelete(t)}}},[e._v(e._s(e.$t("table.delete")))]),e._v(" "),r("el-dropdown-item",{directives:[{name:"has-permission",rawName:"v-has-permission",value:["role:export"],expression:"['role:export']"}],nativeOn:{click:function(t){return e.exportExcel(t)}}},[e._v(e._s(e.$t("table.export")))])],1)],1)],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.tableKey,ref:"table",staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:""},on:{"selection-change":e.onSelectChange,"sort-change":e.sortChange}},[r("el-table-column",{attrs:{type:"selection",align:"center",width:"40px"}}),e._v(" "),r("el-table-column",{attrs:{label:e.$t("table.role.roleName"),prop:"username","show-overflow-tooltip":!0,align:"center","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.roleName))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:e.$t("table.role.remark"),prop:"remark","show-overflow-tooltip":!0,align:"center","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.remark))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:e.$t("table.role.createTime"),prop:"createTime","show-overflow-tooltip":!0,align:"center","min-width":"180px",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.createTime))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:e.$t("table.operation"),align:"center",width:"150px","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[r("i",{directives:[{name:"has-permission",rawName:"v-has-permission",value:["role:update"],expression:"['role:update']"}],staticClass:"el-icon-setting table-operation",staticStyle:{color:"#2db7f5"},on:{click:function(t){return e.edit(s)}}}),e._v(" "),r("i",{directives:[{name:"has-permission",rawName:"v-has-permission",value:["role:delete"],expression:"['role:delete']"}],staticClass:"el-icon-delete table-operation",staticStyle:{color:"#f50"},on:{click:function(t){return e.singleDelete(s)}}}),e._v(" "),r("el-link",{directives:[{name:"has-no-permission",rawName:"v-has-no-permission",value:["role:update","role:delete"],expression:"['role:update','role:delete']"}],staticClass:"no-perm"},[e._v("\n                "+e._s(e.$t("tips.noPermission"))+"\n              ")])]}}])})],1),e._v(" "),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.pagination.num,limit:e.pagination.size},on:{"update:page":function(t){return e.$set(e.pagination,"num",t)},"update:limit":function(t){return e.$set(e.pagination,"size",t)},pagination:e.fetch}})],1)]),e._v(" "),r("el-col",{attrs:{xs:24,sm:10}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v(e._s(""===e.role.roleId?this.$t("common.add"):this.$t("common.edit")))])]),e._v(" "),r("div",[r("el-form",{ref:"form",attrs:{model:e.role,rules:e.rules,"label-position":"right","label-width":"100px"}},[r("el-form-item",{attrs:{label:e.$t("table.role.roleName"),prop:"roleName"}},[r("el-input",{attrs:{readonly:""!==e.role.roleId&&"readonly"},model:{value:e.role.roleName,callback:function(t){e.$set(e.role,"roleName",t)},expression:"role.roleName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("table.role.remark"),prop:"remark"}},[r("el-input",{attrs:{type:"textarea",rows:"3"},model:{value:e.role.remark,callback:function(t){e.$set(e.role,"remark",t)},expression:"role.remark"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("table.role.perms"),prop:"remark"}},[r("el-tree",{ref:"permsTree",attrs:{data:e.permsTree,"check-strictly":!0,"show-checkbox":"",accordion:"","node-key":"id","highlight-current":""}})],1)],1)],1)]),e._v(" "),r("el-card",{staticClass:"box-card"},[r("el-row",[r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[r("el-button",{attrs:{type:"primary",plain:""},on:{click:e.submit}},[e._v(e._s(""===e.role.roleId?this.$t("common.add"):this.$t("common.edit")))])],1)],1)],1)],1)],1)],1)},o=[],a=(r("55dd"),r("386d"),r("ac6a"),r("28a5"),r("db72")),n=r("333d"),i={name:"RoleManage",components:{Pagination:n["a"]},data:function(){var e=this;return{tableKey:0,loading:!1,list:null,selection:[],total:0,permsTree:[],queryParams:{},sort:{},pagination:{size:10,num:1},role:this.initRole(),rules:{roleName:[{required:!0,message:this.$t("rules.require"),trigger:"blur"},{min:3,max:10,message:this.$t("rules.range3to10"),trigger:"blur"},{validator:function(t,r,s){e.role.roleId?s():e.$get("system/role/check/".concat(r)).then((function(t){t.data?s():s(e.$t("rules.roleNameExist"))}))},trigger:"blur"}],remark:{max:50,message:this.$t("rules.noMoreThan50"),trigger:"blur"}}}},mounted:function(){this.fetch(),this.initMenuTree()},methods:{initRole:function(){return{roleId:"",roleName:"",remark:""}},initMenuTree:function(){var e=this;this.$get("system/menu").then((function(t){e.permsTree=t.data.data.rows}))},onSelectChange:function(e){this.selection=e},clearSelections:function(){this.$refs.table.clearSelection()},exportExcel:function(){this.$download("system/role/excel",Object(a["a"])({pageSize:this.pagination.size,pageNum:this.pagination.num},this.queryParams),"role_".concat((new Date).getTime(),".xlsx"))},edit:function(e){this.$refs.form.clearValidate(),this.role=Object(a["a"])({},e),this.role.menuIds?this.$refs.permsTree.setCheckedKeys(this.role.menuIds.split(",")):this.$refs.permsTree.setCheckedKeys([])},singleDelete:function(e){this.$refs.table.toggleRowSelection(e,!0),this.batchDelete()},batchDelete:function(){var e=this;this.selection.length?this.$confirm(this.$t("tips.confirmDelete"),this.$t("common.tips"),{confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),type:"warning"}).then((function(){var t=[];e.selection.forEach((function(e){t.push(e.roleId)})),e.delete(t)})).catch((function(){e.clearSelections()})):this.$message({message:this.$t("tips.noDataSelected"),type:"warning"})},delete:function(e){var t=this;this.$delete("system/role/".concat(e)).then((function(){t.$message({message:t.$t("tips.deleteSuccess"),type:"success"}),t.search()}))},submit:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.role.roleId?(e.role.menuIds=e.$refs.permsTree.getCheckedKeys().join(","),e.role.createTime=e.role.modifyTime=null,e.$put("system/role",Object(a["a"])({},e.role)).then((function(){e.$message({message:e.$t("tips.updateSuccess"),type:"success"}),e.reset()}))):(e.role.menuIds=e.$refs.permsTree.getCheckedKeys().join(","),e.$post("system/role",Object(a["a"])({},e.role)).then((function(){e.$message({message:e.$t("tips.createSuccess"),type:"success"}),e.reset()})))}))},add:function(){this.resetForm()},sortChange:function(e){this.sort.field=e.prop,this.sort.order=e.order,this.search()},reset:function(){this.resetForm(),this.queryParams={},this.sort={},this.$refs.table.clearSort(),this.search()},resetForm:function(){this.$refs.form.clearValidate(),this.$refs.form.resetFields(),this.role=this.initRole(),this.$refs.permsTree.setCheckedKeys([])},search:function(){this.resetForm(),this.fetch(Object(a["a"])({},this.queryParams,{},this.sort))},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,t.pageSize=this.pagination.size,t.pageNum=this.pagination.num,this.$get("system/role",Object(a["a"])({},t)).then((function(t){var r=t.data.data;e.list=r.rows,e.total=r.total,e.loading=!1}))}}},l=i,c=(r("1b25"),r("2877")),u=Object(c["a"])(l,s,o,!1,null,"5ccb72dc",null);t["default"]=u.exports}}]);