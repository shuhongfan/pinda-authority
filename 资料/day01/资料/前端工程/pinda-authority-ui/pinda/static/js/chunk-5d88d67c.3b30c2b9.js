(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d88d67c","chunk-32a25c25"],{"09f4":function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),Math.easeInOutQuad=function(e,t,i,a){return e/=a/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function n(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(e,t,i){var r=o(),l=e-r,s=20,c=0;t="undefined"===typeof t?500:t;var d=function e(){c+=s;var o=Math.easeInOutQuad(c,r,l,t);n(o),c<t?a(e):i&&"function"===typeof i&&i()};d()}},"26a0":function(e,t,i){"use strict";var a=i("b866"),n=i.n(a);n.a},"2f21":function(e,t,i){"use strict";var a=i("79e5");e.exports=function(e,t){return!!e&&a((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},"55dd":function(e,t,i){"use strict";var a=i("5ca1"),n=i("d8e8"),o=i("4bf8"),r=i("79e5"),l=[].sort,s=[1,2,3];a(a.P+a.F*(r((function(){s.sort(void 0)}))||!r((function(){s.sort(null)}))||!i("2f21")(l)),"Array",{sort:function(e){return void 0===e?l.call(o(this)):l.call(o(this),n(e))}})},"64e1":function(e,t,i){e.exports=i.p+"static/img/404_image.db638609.jpeg"},"73a8":function(e,t,i){},"83d6":function(e,t){e.exports={title:"微服务权限管理平台",onlinePreview:"http://127.0.0.1:8012/onlinePreview?url=",druid:{authority:{development:"http://127.0.0.1:8764/druid",production:"http://39.100.244.120:8764/druid"},file:{development:"http://127.0.0.1:8765/druid",production:"http://39.100.244.120:8765/druid"}}}},a81c:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item search-item",attrs:{placeholder:e.$t("table.attachment.submittedFileName")},model:{value:e.queryParams.submittedFileName,callback:function(t){e.$set(e.queryParams,"submittedFileName",t)},expression:"queryParams.submittedFileName"}}),e._v(" "),i("el-date-picker",{staticClass:"filter-item search-item date-range-item",attrs:{"range-separator":null,"end-placeholder":"结束日期",format:"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期",type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.queryParams.timeRange,callback:function(t){e.$set(e.queryParams,"timeRange",t)},expression:"queryParams.timeRange"}}),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{plain:"",type:"primary"},on:{click:e.search}},[e._v(e._s(e.$t("table.search")))]),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{plain:"",type:"warning"},on:{click:e.reset}},[e._v(e._s(e.$t("table.reset")))]),e._v(" "),i("el-dropdown",{directives:[{name:"has-any-permission",rawName:"v-has-any-permission",value:["file:add","file:delete","file:download"],expression:"['file:add', 'file:delete', 'file:download']"}],staticClass:"filter-item",attrs:{trigger:"click"}},[i("el-button",[e._v("\n        "+e._s(e.$t("table.more"))+"\n        "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{directives:[{name:"has-permission",rawName:"v-has-permission",value:["file:add"],expression:"['file:add']"}],nativeOn:{click:function(t){return e.upload(t)}}},[e._v(e._s(e.$t("table.upload")))]),e._v(" "),i("el-dropdown-item",{directives:[{name:"has-permission",rawName:"v-has-permission",value:["file:delete"],expression:"['file:delete']"}],nativeOn:{click:function(t){return e.batchDelete(t)}}},[e._v(e._s(e.$t("table.delete")))]),e._v(" "),i("el-dropdown-item",{directives:[{name:"has-permission",rawName:"v-has-permission",value:["file:download"],expression:"['file:download']"}],nativeOn:{click:function(t){return e.batchDownload(t)}}},[e._v(e._s(e.$t("table.download")))])],1)],1)],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.tableKey,ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData.records,border:"",fit:""},on:{"selection-change":e.onSelectChange,"sort-change":e.sortChange}},[i("el-table-column",{attrs:{align:"center",type:"selection",width:"40px"}}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("table.attachment.submittedFileName"),"show-overflow-tooltip":!0,align:"left",prop:"submittedFileName"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{on:{click:function(i){return e.onView(t.row)}}},[i("i",{staticClass:"button-list",class:t.row.icon}),e._v(" "),i("span",[e._v(e._s(t.row.submittedFileName))])])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("table.attachment.dataType"),"show-overflow-tooltip":!0,align:"center",prop:"dataType",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.dataType.desc))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("table.attachment.bizType"),"show-overflow-tooltip":!0,align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.bizType))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("table.attachment.bizId"),"show-overflow-tooltip":!0,align:"center",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.bizId))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("table.attachment.size"),align:"center","show-overflow-tooltip":!0,width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.formatSize(t.row)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("table.createTime"),align:"center",prop:"createTime",sortable:"custom",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.createTime))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("table.operation"),align:"center","class-name":"small-padding fixed-width",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("i",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:["file:download"],expression:"['file:download']"}],staticClass:"el-icon-download table-operation",staticStyle:{color:"#f50"},on:{click:function(t){return e.singleDownload(a)}}}),e._v(" "),i("i",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:["file:delete"],expression:"['file:delete']"}],staticClass:"el-icon-delete table-operation",staticStyle:{color:"#f50"},on:{click:function(t){return e.singleDelete(a)}}}),e._v(" "),i("el-link",{directives:[{name:"has-no-permission",rawName:"v-has-no-permission",value:["file:update","file:delete"],expression:"['file:update', 'file:delete']"}],staticClass:"no-perm"},[e._v(e._s(e.$t("tips.noPermission")))])]}}])})],1),e._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.tableData.total>0,expression:"tableData.total > 0"}],attrs:{limit:e.pagination.size,page:e.pagination.current,total:Number(e.tableData.total)},on:{"update:limit":function(t){return e.$set(e.pagination,"size",t)},"update:page":function(t){return e.$set(e.pagination,"current",t)},pagination:e.fetch}}),e._v(" "),i("attachment-edit",{ref:"edit",attrs:{"dialog-visible":e.dialog.isVisible,type:e.dialog.type},on:{close:e.editClose,success:e.editSuccess}}),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogImageUrl?i("img",{key:e.dialogImageUrl,attrs:{src:e.dialogImageUrl,alt:"图片飞到火星了",height:"500px",width:"100%"},on:{error:function(t){return e.errorImage()}}}):i("span",[e._v("图片飞到火星了~")])])],1)},n=[],o=(i("28a5"),i("6762"),i("2fdb"),i("ac6a"),i("55dd"),i("db72")),r=(i("386d"),i("333d")),l=i("f514"),s=i("9256"),c={page:{method:"GET",url:"/file/attachment/page"},upload:{method:"POST",url:"/file/attachment/upload"},download:{method:"GET",url:"/file/attachment/download"},downloadBiz:{method:"GET",url:"/file/attachment/download/biz"},downloadUrl:{method:"GET",url:"/file/attachment/download/url"},delete:{method:"DELETE",url:"/file/attachment"}},d={page:function(e){return Object(s["a"])(Object(o["a"])({},c.page,{formData:!0,data:e}))},upload:function(e){return Object(s["a"])(Object(o["a"])({},c.upload,{data:e}))},download:function(e){return Object(s["a"])(Object(o["a"])({},c.download,{responseType:"blob",data:e}))},downloadBiz:function(e){return Object(s["a"])(Object(o["a"])({},c.downloadBiz,{data:e}))},downloadUrl:function(e){return Object(s["a"])(Object(o["a"])({},c.downloadUrl,{data:e}))},delete:function(e){return Object(s["a"])(Object(o["a"])({},c.delete,{data:e}))}},u=i("fa7d"),f=i("83d6"),m={name:"AttachmentManage",components:{Pagination:r["a"],AttachmentEdit:l["default"]},filters:{},data:function(){return{dialogVisible:!1,dialogImageUrl:"",dialog:{isVisible:!1,type:"add"},tableKey:0,queryParams:{},sort:{},selection:[],loading:!1,tableData:{records:[],total:0},pagination:{size:10,current:1}}},computed:{},mounted:function(){this.fetch()},methods:{errorImage:function(){var e=event.srcElement;e.src=i("64e1"),e.onerror=null},formatSize:function(e){return Object(u["c"])(e.size)},filterStatus:function(e,t){return t.status===e},editClose:function(){this.dialog.isVisible=!1},editSuccess:function(){this.search()},onSelectChange:function(e){this.selection=e},search:function(){this.fetch(Object(o["a"])({},this.queryParams,{},this.sort))},reset:function(){this.queryParams={},this.sort={},this.$refs.table.clearSort(),this.$refs.table.clearFilter(),this.search()},singleDownload:function(e){this.$refs.table.toggleRowSelection(e,!0),this.batchDownload()},singleDelete:function(e){this.$refs.table.toggleRowSelection(e,!0),this.batchDelete()},batchDownload:function(){var e=this;this.selection.length?this.$confirm("确认下载吗？",this.$t("common.tips"),{confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),type:"warning"}).then((function(){var t=[];e.selection.forEach((function(e){t.push(e.id)})),e.download(t)})).catch((function(){e.clearSelections()})):this.$message({message:this.$t("tips.noDataSelected"),type:"warning"})},batchDelete:function(){var e=this;this.selection.length?this.$confirm(this.$t("tips.confirmDelete"),this.$t("common.tips"),{confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),type:"warning"}).then((function(){var t=[];e.selection.forEach((function(e){t.push(e.id)})),e.delete(t)})).catch((function(){e.clearSelections()})):this.$message({message:this.$t("tips.noDataSelected"),type:"warning"})},clearSelections:function(){this.$refs.table.clearSelection()},download:function(e){var t=this;d.download({ids:e}).then((function(e){var i=e.data,a=i.type;if(a.includes("application/json")){var n=new FileReader;n.onload=function(e){if(2===e.target.readyState){var i=JSON.parse(e.target.result);t.$message({message:i.msg,type:"warning"})}},n.readAsText(i)}else{var o=e.headers["content-disposition"],r="下载文件.zip";if(o)for(var l=o.split(";"),s=0;s<l.length;s++){var c=l[s];if(null!==c&&""!==c){var d=c.split("=");if(null!==d&&d.length>0&&"filename"===d[0].toLowerCase()){r=decodeURI(d[1]);break}}}var u=new Blob([i]),f=document.createElement("a");f.href=window.URL.createObjectURL(u),f.download=r,f.click(),window.URL.revokeObjectURL(f.href)}t.clearSelections()}))},delete:function(e){var t=this;d.delete({ids:e}).then((function(e){var i=e.data;i.isSuccess&&t.$message({message:t.$t("tips.deleteSuccess"),type:"success"}),t.search()}))},onView:function(e){e.url&&window.open(f["onlinePreview"]+encodeURIComponent(e.url))},upload:function(){this.dialog.type="upload",this.dialog.isVisible=!0,this.$refs.edit.setAttachment(!1)},edit:function(e){this.$refs.edit.setAttachment(e),this.dialog.type="edit",this.dialog.isVisible=!0},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,t.size=this.pagination.size,t.current=this.pagination.current,this.queryParams.timeRange&&(t.startCreateTime=this.queryParams.timeRange[0],t.endCreateTime=this.queryParams.timeRange[1]),d.page(t).then((function(t){var i=t.data;e.loading=!1,i.isSuccess&&(e.tableData=i.data)})).catch((function(){e.loading=!1}))},sortChange:function(e){this.sort.field=e.prop,this.sort.order=e.order,this.search()}}},h=m,p=(i("26a0"),i("2877")),b=Object(p["a"])(h,a,n,!1,null,"6cb0ccf1",null);t["default"]=b.exports},b866:function(e,t,i){},c2cf:function(e,t,i){"use strict";var a=i("9256"),n=i("5657"),o={dictionaryEnums:"/gate/dictionary/enums"};t["a"]={uploadFile:"".concat("http://localhost:8760").concat("/api","/file/attachment/upload"),loadImg:function(e){var t=n["a"].get("TOKEN",""),i=n["a"].get("TENANT","");return"".concat("http://localhost:8760").concat("/api","/file/attachment/download/").concat(e.bizType,"/").concat(e.bizId,"?token=").concat(t,"&tenant=").concat(i)},dictionaryEnums:function(){return Object(a["a"])({method:"GET",url:o.dictionaryEnums})},generateId:function(e){return Object(a["a"])({url:"/authority/common/generateId",method:"GET",data:e})},getAttachment:function(e){return Object(a["a"])({url:"/file/attachment",method:"get",data:e})},deleteAttachment:function(e){return Object(a["a"])({url:"/file/attachment",method:"delete",data:e})},downloadAttachment:function(e){return Object(a["a"])({url:"/file/attachment/download",method:"get",responseType:"blob",data:e})},downloadAttachmentBiz:function(e){return Object(a["a"])({url:"/file/attachment/download/biz",method:"get",responseType:"blob",data:e})}}},dfdf:function(e,t,i){"use strict";var a=i("73a8"),n=i.n(a);n.a},f514:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{"close-on-click-modal":!1,title:e.title,type:e.type,visible:e.isVisible,width:e.width,top:"50px"},on:{"update:visible":function(t){e.isVisible=t},dragDialog:e.handleDrag}},[i("el-form",{ref:"form",attrs:{model:e.attachment,rules:e.rules,"label-position":"right","label-width":"100px"}},[i("el-form-item",{attrs:{label:e.$t("table.attachment.bizId"),prop:"bizId"}},[i("el-input",{model:{value:e.attachment.bizId,callback:function(t){e.$set(e.attachment,"bizId",t)},expression:"attachment.bizId"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("table.attachment.bizType"),prop:"bizType"}},[i("el-input",{model:{value:e.attachment.bizType,callback:function(t){e.$set(e.attachment,"bizType",t)},expression:"attachment.bizType"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"文件",prop:"fileLength"}},[i("fileUpload",{ref:"fileRef",attrs:{"accept-size":2097152,"auto-upload":!1,limit:5},on:{fileLengthVaild:e.fileLengthVaild,setId:e.setIdAndSubmit}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("文件不超过2MB")])],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{plain:"",type:"warning"},on:{click:function(t){e.isVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),i("el-button",{attrs:{disabled:e.disabled,plain:"",type:"primary"},on:{click:e.submitForm}},[e._v(e._s(e.$t("common.confirm")))])],1)],1)},n=[],o=i("db72"),r=(i("a481"),i("6762"),i("2fdb"),{bind:function(e,t,i){var a=e.querySelector(".el-dialog__header"),n=e.querySelector(".el-dialog");a.style.cssText+=";cursor:move;",n.style.cssText+=";top:0px;";var o=function(){return window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]}}();a.onmousedown=function(e){var t=e.clientX-a.offsetLeft,r=e.clientY-a.offsetTop,l=n.offsetWidth,s=n.offsetHeight,c=document.body.clientWidth,d=document.body.clientHeight,u=n.offsetLeft,f=c-n.offsetLeft-l,m=n.offsetTop,h=d-n.offsetTop-s,p=o(n,"left"),b=o(n,"top");p.includes("%")?(p=+document.body.clientWidth*(+p.replace(/\%/g,"")/100),b=+document.body.clientHeight*(+b.replace(/\%/g,"")/100)):(p=+p.replace(/\px/g,""),b=+b.replace(/\px/g,"")),document.onmousemove=function(e){var a=e.clientX-t,o=e.clientY-r;-a>u?a=-u:a>f&&(a=f),-o>m?o=-m:o>h&&(o=h),n.style.cssText+=";left:".concat(a+p,"px;top:").concat(o+b,"px;"),i.child.$emit("dragDialog")},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null}}}}),l=function(e){e.directive("el-drag-dialog",r)};window.Vue&&(window["el-drag-dialog"]=r,Vue.use(l)),r.install=l;var s=r,c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-upload",{ref:e.uploadRef,staticClass:"upload-demo",class:!1===e.isUpload?"hidebtn":"",attrs:{accept:e.accept,action:e.action,"auto-upload":e.autoUpload,"before-remove":e.beforeRemove,data:e.fileOtherData,"file-list":e.fileList,headers:e.headers,limit:e.limit,multiple:e.multiple,"on-change":e.handleChange,"on-error":e.handleError,"on-exceed":e.handleExceed,"on-preview":e.handlePreview,"on-remove":e.handleRemove}},[e.isUpload?i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]):e._e()],1)],1)},d=[],u=(i("96cf"),i("3b8d")),f=(i("ac6a"),i("7f7f"),i("c5f6"),i("5657")),m=i("c2cf"),h={name:"FileUpload",props:{uploadRef:{type:String,default:"file1"},multiple:{type:Boolean,default:!0},autoUpload:{type:Boolean,default:!0},isUpload:{type:Boolean,default:!0},limit:{type:Number,default:null},accept:{type:String,default:""},acceptSize:{type:Number,default:null},fileOtherData:{type:Object,default:function(){return{id:null,bizId:"",bizType:"",isSingle:!1}}}},data:function(){return{fileList:[],removeFileAry:[],addFileAry:[],successNum:0,errorNum:0,uploadTotalNum:0,isUploadError:!1,action:"".concat("/api","/file/attachment/upload")}},computed:{headers:function(){return{token:f["a"].get("TOKEN","")||"",tenant:f["a"].get("TENANT","")||""}}},methods:{init:function(e){var t=e.id,i=e.bizId,a=e.bizType,n=e.isSingle,o=e.isDetail,r=this;r.fileOtherData.bizId=i,r.fileOtherData.id=t||"",r.fileOtherData.bizType=a,r.fileOtherData.isSingle=n||!1,r.fileList.length=0,r.removeFileAry=[],r.addFileAry=[],r.$emit("fileLengthVaild",0),o&&r.getAttachment(),r.successNum=0,r.errorNum=0,r.uploadTotalNum=0,r.$refs[r.uploadRef].clearFiles()},handleChange:function(e,t){var i=this;if(e.response)i.uploadTotalNum+=1,e.response.isSuccess?(i.fileOtherData.bizId=e.response.data.bizId,i.successNum+=1):(setTimeout((function(){i.$message({message:e.name+"上传失败，原因：\n"+e.response.msg,type:"error",showClose:!0,duration:6e3})}),0),i.isUploadError=!1,i.errorNum+=1),i.$emit("setId",i.uploadTotalNum===t.length,e.response);else{if(i.acceptSize){var a=e.size>i.acceptSize;a?(setTimeout((function(){i.$message.error("只能上传"+i.renderSize(i.acceptSize)+"的文件!已为您过滤文件："+e.name)}),10),t.forEach((function(i,a){i.uid===e.uid&&t.splice(a,1)}))):(i.isUploadError||i.addFileAry.push(e.name),i.isUploadError=!1)}else i.isUploadError||i.addFileAry.push(e.name),i.isUploadError=!1;i.$emit("fileLengthVaild",i.fileList.length+i.addFileAry.length)}i.$store.state.hasLoading=!1},handleError:function(){var e=this;e.$message.error("附件上传失败，请重试"),e.isUploadError=!0,e.$store.state.hasLoading=!1},renderSize:function(e){if(null==e||""==e)return"0 B";var t=new Array("B","KB","MB","GB","TB","PB","EB","ZB","YB"),i=0,a=parseFloat(e);i=Math.floor(Math.log(a)/Math.log(1024));var n=a/Math.pow(1024,i);return n=n.toFixed(2),t[i]?n+t[i]:"文件太大"},handlePreview:function(e){e.bizId&&this.downLoadFile(e)},beforeRemove:function(e){return this.$confirm("确定移除"+e.name,"删除确认")},handleExceed:function(){var e=this;e.$message("当前最多允许上传"+e.limit+"个文件")},handleRemove:function(e){var t=this;e.bizId?(t.removeFileAry.push(e.id),t.fileList.map((function(i,a){if(i.name===e.name)return t.fileList.splice(a,1),!1}))):t.addFileAry.map((function(i,a){if(i===e.name)return t.addFileAry.splice(a,1),!1})),t.$emit("fileLengthVaild",t.fileList.length+t.addFileAry.length)},deleteAttachment:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,m["a"].deleteAttachment({ids:t.removeFileAry});case 3:i=e.sent,200===i.status&&(0!==i.data.code?t.$message(i.data.msg):t.removeFileAry=[]);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getAttachment:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,m["a"].getAttachment({bizIds:t.fileOtherData.bizId,bizTypes:t.fileOtherData.bizType});case 3:i=e.sent,200===i.status&&0===i.data.code&&i.data.data.length>0&&(a=i.data.data[0].list,a.map((function(e){e.name=e.submittedFileName})),t.fileList=a,t.$emit("fileLengthVaild",t.fileList.length));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getAttachmentByArr:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,i){var a,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=this,e.next=3,m["a"].getAttachment({bizIds:t,bizTypes:i});case 3:n=e.sent,200===n.status&&0===n.data.code&&n.data.data.length>0&&(o=n.data.data[0].list,o.map((function(e){e.name=e.submittedFileName})),a.fileList=o);case 5:case"end":return e.stop()}}),e,this)})));function t(t,i){return e.apply(this,arguments)}return t}(),handleBack:function(){var e=this;return{addLength:e.addFileAry.length,removeLength:e.removeFileAry.length}},submitFile:function(e,t,i){var a=this;a.fileOtherData.id=e,t&&(a.fileOtherData.bizId=t,a.isUpload=!0),a.fileOtherData.bizType=i,a.$refs[a.uploadRef].submit(),a.addFileAry=[]},downLoadFile:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=document.createElement("a"),i.href=t.url,i.download=t.name,i.click(),window.URL.revokeObjectURL(i.href);case 5:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}},p=h,b=(i("dfdf"),i("2877")),g=Object(b["a"])(p,c,d,!1,null,null,null),v=g.exports,w={name:"AttachmentEdit",directives:{elDragDialog:s,fileUpload:v},components:{fileUpload:v},props:{dialogVisible:{type:Boolean,default:!1},type:{type:String,default:"add"}},data:function(){var e=this;return{accept:"image/jpeg, image/gif, image/png",attachment:this.initAttachment(),screenWidth:0,width:this.initWidth(),fileLength:0,disabled:!1,rules:{bizType:[{required:!0,message:this.$t("rules.require"),trigger:"blur"},{min:0,max:255,message:this.$t("rules.range0to255"),trigger:"blur"}],bizId:{min:0,max:255,message:this.$t("rules.range0to255"),trigger:"blur"},fileLength:{required:!0,trigger:"change",validator:function(t,i,a){var n=e;0===n.fileLength?a(new Error("请上传文件")):n.fileLength>5?a(new Error("一次性只能上传5个文件")):a()}}}}},computed:{isVisible:{get:function(){return this.dialogVisible},set:function(){this.close(),this.reset()}},title:function(){return this.$t("common.upload")}},watch:{},mounted:function(){var e=this;window.onresize=function(){return function(){e.width=e.initWidth()}()}},methods:{initAttachment:function(){return{id:"",bizId:"",bizType:"",file:null,isSingle:!1}},handleDrag:function(){console.log("我被拖动了")},fileLengthVaild:function(e){var t=this;t.fileLength=e||0},initWidth:function(){return this.screenWidth=document.body.clientWidth,this.screenWidth<991?"90%":this.screenWidth<1400?"45%":"800px"},setAttachment:function(e){var t=this;e&&(t.attachment=Object(o["a"])({},e))},close:function(){this.$emit("close")},reset:function(){this.$refs.form.clearValidate(),this.$refs.form.resetFields(),this.attachment=this.initAttachment(),this.$refs.fileRef.init({id:"",bizId:"",bizType:""})},submitForm:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.editSubmit()}))},editSubmit:function(){var e=this;e.disabled=!0,e.$refs.fileRef.submitFile(this.attachment.id,this.attachment.bizId,this.attachment.bizType)},setIdAndSubmit:function(e){var t=this;e&&(t.disabled=!1,t.isVisible=!1,t.$message({message:t.$t("tips.createSuccess"),type:"success"}),t.$emit("success"))}}},y=w,$=Object(b["a"])(y,a,n,!1,null,"902e05fc",null);t["default"]=$.exports},fa7d:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return o}));i("4917");var a=function(e){var t={terminal:"",browser:"",terminalType:{}};return t.terminalType={trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&-1===e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Adr")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:-1===e.indexOf("Safari"),weixin:e.indexOf("MicroMessenger")>-1,qq:" qq"===e.match(/\sQQ/i)},t.terminalType.ios||t.terminalType.iPhone||t.terminalType.iPad?t.terminal="苹果":t.terminalType.android?t.terminal="安卓":t.terminal="PC",/msie/i.test(e)&&!/opera/.test(e)?t.browser="IE":/firefox/i.test(e)?t.browser="Firefox":/chrome/i.test(e)&&/webkit/i.test(e)&&/mozilla/i.test(e)?t.browser="Chrome":/opera/i.test(e)?t.browser="Opera":/iPad/i.test(e)?t.browser="iPad":!/webkit/i.test(e)||/chrome/i.test(e)&&/webkit/i.test(e)&&/mozilla/i.test(e)?t.browser="未知":t.browser="Safari",t},n=function(e){if(null==e||""==e)return"0 B";var t=new Array("B","KB","MB","GB","TB","PB","EB","ZB","YB"),i=0,a=parseFloat(e);i=Math.floor(Math.log(a)/Math.log(1024));var n=a/Math.pow(1024,i);return n=n.toFixed(2),t[i]?n+t[i]:"文件太大"},o=function(e){var t=[];if(e)for(var i in e)t.push({text:e[i],value:i});return t}}}]);