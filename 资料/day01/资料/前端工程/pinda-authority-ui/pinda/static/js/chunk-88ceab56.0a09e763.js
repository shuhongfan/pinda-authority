(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-88ceab56"],{"0328":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{"close-on-click-modal":!1,title:e.title,type:e.type,visible:e.isVisible,width:e.width,top:"50px"},on:{"update:visible":function(t){e.isVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.role,rules:e.rules,"label-position":"right","label-width":"100px"}},[r("el-form-item",{attrs:{label:e.$t("table.role.code"),prop:"code"}},[r("el-input",{attrs:{disabled:"edit"===e.type},model:{value:e.role.code,callback:function(t){e.$set(e.role,"code",t)},expression:"role.code"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("table.role.name"),prop:"name"}},[r("el-input",{model:{value:e.role.name,callback:function(t){e.$set(e.role,"name",t)},expression:"role.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("table.role.status"),prop:"status"}},[r("el-radio-group",{model:{value:e.role.status,callback:function(t){e.$set(e.role,"status",t)},expression:"role.status"}},[r("el-radio-button",{attrs:{label:!0}},[e._v(e._s(e.$t("common.status.valid")))]),e._v(" "),r("el-radio-button",{attrs:{label:!1}},[e._v(e._s(e.$t("common.status.invalid")))])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("table.role.describe"),prop:"describe"}},[r("el-input",{model:{value:e.role.describe,callback:function(t){e.$set(e.role,"describe",t)},expression:"role.describe"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("table.role.dsType"),prop:"dsType"}},[r("el-radio-group",{on:{change:e.dsTypeChange},model:{value:e.role.dsType.code,callback:function(t){e.$set(e.role.dsType,"code",t)},expression:"role.dsType.code"}},e._l(e.enums.DataScopeType,(function(t,o,i){return r("el-radio-button",{key:i,attrs:{label:o,value:o}},[e._v(e._s(t))])})),1)],1),e._v(" "),r("el-form-item",{attrs:{hidden:e.orgHidden,label:e.$t("table.role.orgList"),prop:"orgList"}},[r("el-tree",{ref:"orgTree",attrs:{"check-strictly":!0,data:e.orgList,"default-checked-keys":e.role.orgList,"default-expanded-keys":e.role.orgList,"expand-on-click-node":!1,"highlight-current":"","node-key":"id","show-checkbox":""}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{plain:"",type:"warning"},on:{click:function(t){e.isVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),r("el-button",{attrs:{plain:"",type:"primary"},on:{click:e.submitForm}},[e._v(e._s(e.$t("common.confirm")))])],1)],1)},i=[],a=r("db72"),s=r("61d9"),n=r("c38b"),l={name:"RoleEdit",components:{},props:{dialogVisible:{type:Boolean,default:!1},type:{type:String,default:"add"}},data:function(){var e=this;return{role:this.initRole(),screenWidth:0,width:this.initWidth(),orgList:[],orgHidden:!0,rules:{name:[{required:!0,message:this.$t("rules.require"),trigger:"blur"},{min:1,max:255,message:this.$t("rules.range4to10"),trigger:"blur"},{validator:function(t,r,o){"add"===!e.type&&r.trim().length>0?s["a"].check(r).then((function(e){var t=e.data;t.data?o("编码重复"):o()})):o(),o()},trigger:"blur"}],status:{required:!0,message:this.$t("rules.require"),trigger:"blur"},orgList:{validator:function(t,r,o){"CUSTOMIZE"===e.role.dsType.code?e.$refs.orgTree.getCheckedKeys().length>0?o():o("请至少选择一个单位或部门"):o()}}}}},computed:{isVisible:{get:function(){return this.dialogVisible},set:function(){this.close(),this.reset()}},title:function(){return"add"===this.type?this.$t("common.add"):this.$t("common.edit")},enums:function(){return this.$store.state.common.enums}},watch:{},mounted:function(){var e=this;this.initOrg(),window.onresize=function(){return function(){e.width=e.initWidth()}()}},methods:{initRole:function(){return{id:"",code:"",name:"",orgList:[],status:!0,describe:"",dsType:{code:"SELF",desc:""}}},initWidth:function(){return this.screenWidth=document.body.clientWidth,this.screenWidth<991?"90%":this.screenWidth<1400?"45%":"800px"},initOrg:function(){var e=this;n["a"].allTree({status:!0}).then((function(t){var r=t.data;e.orgList=r.data}))},loadListOptions:function(e){var t=e.callback;t()},setRole:function(e){var t=this,r=this;e&&(r.role=Object(a["a"])({},e),this.orgHidden="CUSTOMIZE"!==e.dsType.code,this.orgHidden||s["a"].get(e.id).then((function(e){var r=e.data;r.isSuccess&&(t.role.orgList=r.data.orgList,t.$refs.orgTree.setCheckedKeys(r.data.orgList))})))},close:function(){this.$emit("close")},reset:function(){this.$refs.form.clearValidate(),this.$refs.form.resetFields(),this.role=this.initRole(),this.orgHidden=!0,this.$refs.orgTree.setCheckedKeys([])},submitForm:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.editSubmit()}))},editSubmit:function(){var e=this;this.orgHidden&&this.role.orgList?this.role.orgList.length=0:this.role.orgList=this.$refs.orgTree.getCheckedKeys(),"add"===e.type?e.save():e.update()},save:function(){var e=this;s["a"].save(this.role).then((function(t){var r=t.data;r.isSuccess&&(e.isVisible=!1,e.$message({message:e.$t("tips.createSuccess"),type:"success"}),e.$emit("success"))}))},update:function(){var e=this;s["a"].update(this.role).then((function(t){var r=t.data;r.isSuccess&&(e.isVisible=!1,e.$message({message:e.$t("tips.updateSuccess"),type:"success"}),e.$emit("success"))}))},dsTypeChange:function(e){this.orgHidden="CUSTOMIZE"!==e}}},c=l,u=r("2877"),d=Object(u["a"])(c,o,i,!1,null,"15a1df9a",null);t["default"]=d.exports},"61d9":function(e,t,r){"use strict";var o=r("db72"),i=r("9256"),a={page:{url:"/authority/role/page",method:"GET"},save:{url:"/authority/role",method:"POST"},update:{url:"/authority/role",method:"PUT"},delete:{url:"/authority/role",method:"DELETE"},saveUserRole:{url:"/authority/role/user",method:"POST"},saveRoleAuthority:{url:"/authority/role/authority",method:"POST"}};t["a"]={page:function(e){return Object(i["a"])(Object(o["a"])({},a.page,{formData:!0,data:e}))},save:function(e){return Object(i["a"])(Object(o["a"])({},a.save,{data:e}))},update:function(e){return Object(i["a"])(Object(o["a"])({},a.update,{data:e}))},delete:function(e){return Object(i["a"])(Object(o["a"])({},a.delete,{data:e}))},get:function(e){return Object(i["a"])({url:"/authority/role/".concat(e),method:"GET"})},check:function(e){return Object(i["a"])({url:"/authority/role/check/".concat(e),method:"GET"})},saveUserRole:function(e){return Object(i["a"])(Object(o["a"])({},a.saveUserRole,{data:e}))},findUserIdByRoleId:function(e){return Object(i["a"])({url:"/authority/role/user/".concat(e),method:"GET"})},findAuthorityIdByRoleId:function(e){return Object(i["a"])({url:"/authority/role/authority/".concat(e),method:"GET"})},saveRoleAuthority:function(e){return Object(i["a"])(Object(o["a"])({},a.saveRoleAuthority,{data:e}))}}},c38b:function(e,t,r){"use strict";var o=r("db72"),i=r("9256"),a={allTree:{method:"GET",url:"/authority/org/tree"},save:{method:"POST",url:"/authority/org"},update:{method:"PUT",url:"/authority/org"},delete:{method:"DELETE",url:"/authority/org"}};t["a"]={allTree:function(e){return Object(i["a"])(Object(o["a"])({},a.allTree,{formData:!0,data:e}))},save:function(e){return Object(i["a"])(Object(o["a"])({},a.save,{data:e}))},update:function(e){return Object(i["a"])(Object(o["a"])({},a.update,{data:e}))},delete:function(e){return Object(i["a"])(Object(o["a"])({},a.delete,{data:e}))}}}}]);